[2025-10-11 00:20:26,040] [INFO] [real_accelerator.py:260:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-10-11 00:20:28,126] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[2025-10-11 00:20:28,491] [WARNING] [runner.py:220:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected VISIBLE_DEVICES=0,1: setting --include=localhost:0,1
[2025-10-11 00:20:28,491] [INFO] [runner.py:610:main] cmd = /home/jwlee/miniconda3/envs/train/bin/python3.11 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMV19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None /home/jwlee/volume/Qwen2-vl-finetune-wo/scripts/train_sft.py --use_liger True --lora_enable True --use_dora False --lora_namespan_exclude ['lm_head', 'embed_tokens'] --lora_rank 32 --lora_alpha 32 --lora_dropout 0.05 --num_lora_modules -1 --deepspeed /home/jwlee/volume/Qwen2-vl-finetune-wo/scripts/zero3_offload.json --model_id Qwen/Qwen2-VL-2B-Instruct --data_path /home/jwlee/volume/Qwen2-vl-finetune-wo/synth_rx/train_cord.json --image_folder /home/jwlee/volume/Qwen2-vl-finetune-wo/data/cord_sample/images --remove_unused_columns False --freeze_vision_tower False --freeze_llm True --freeze_merger False --bf16 True --fp16 False --disable_flash_attn2 False --output_dir /home/jwlee/volume/Qwen2-vl-finetune-wo/output/qwen2vl_cord --num_train_epochs 2 --per_device_train_batch_size 2 --gradient_accumulation_steps 8 --image_min_pixels 200704 --image_max_pixels 1097600 --learning_rate 1e-4 --merger_lr 1e-5 --vision_lr 2e-6 --weight_decay 0.1 --warmup_ratio 0.03 --lr_scheduler_type cosine --logging_steps 1 --tf32 True --gradient_checkpointing True --report_to tensorboard --lazy_preprocess True --save_strategy steps --save_steps 50 --save_total_limit 5 --dataloader_num_workers 2
[2025-10-11 00:20:29,679] [INFO] [real_accelerator.py:260:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-10-11 00:20:31,786] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[2025-10-11 00:20:32,142] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1]}
[2025-10-11 00:20:32,143] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=2, node_rank=0
[2025-10-11 00:20:32,143] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1]})
[2025-10-11 00:20:32,143] [INFO] [launch.py:164:main] dist_world_size=2
[2025-10-11 00:20:32,143] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1
[2025-10-11 00:20:32,143] [INFO] [launch.py:256:main] process 64780 spawned with command: ['/home/jwlee/miniconda3/envs/train/bin/python3.11', '-u', '/home/jwlee/volume/Qwen2-vl-finetune-wo/scripts/train_sft.py', '--local_rank=0', '--use_liger', 'True', '--lora_enable', 'True', '--use_dora', 'False', '--lora_namespan_exclude', "['lm_head', 'embed_tokens']", '--lora_rank', '32', '--lora_alpha', '32', '--lora_dropout', '0.05', '--num_lora_modules', '-1', '--deepspeed', '/home/jwlee/volume/Qwen2-vl-finetune-wo/scripts/zero3_offload.json', '--model_id', 'Qwen/Qwen2-VL-2B-Instruct', '--data_path', '/home/jwlee/volume/Qwen2-vl-finetune-wo/synth_rx/train_cord.json', '--image_folder', '/home/jwlee/volume/Qwen2-vl-finetune-wo/data/cord_sample/images', '--remove_unused_columns', 'False', '--freeze_vision_tower', 'False', '--freeze_llm', 'True', '--freeze_merger', 'False', '--bf16', 'True', '--fp16', 'False', '--disable_flash_attn2', 'False', '--output_dir', '/home/jwlee/volume/Qwen2-vl-finetune-wo/output/qwen2vl_cord', '--num_train_epochs', '2', '--per_device_train_batch_size', '2', '--gradient_accumulation_steps', '8', '--image_min_pixels', '200704', '--image_max_pixels', '1097600', '--learning_rate', '1e-4', '--merger_lr', '1e-5', '--vision_lr', '2e-6', '--weight_decay', '0.1', '--warmup_ratio', '0.03', '--lr_scheduler_type', 'cosine', '--logging_steps', '1', '--tf32', 'True', '--gradient_checkpointing', 'True', '--report_to', 'tensorboard', '--lazy_preprocess', 'True', '--save_strategy', 'steps', '--save_steps', '50', '--save_total_limit', '5', '--dataloader_num_workers', '2']
[2025-10-11 00:20:32,144] [INFO] [launch.py:256:main] process 64781 spawned with command: ['/home/jwlee/miniconda3/envs/train/bin/python3.11', '-u', '/home/jwlee/volume/Qwen2-vl-finetune-wo/scripts/train_sft.py', '--local_rank=1', '--use_liger', 'True', '--lora_enable', 'True', '--use_dora', 'False', '--lora_namespan_exclude', "['lm_head', 'embed_tokens']", '--lora_rank', '32', '--lora_alpha', '32', '--lora_dropout', '0.05', '--num_lora_modules', '-1', '--deepspeed', '/home/jwlee/volume/Qwen2-vl-finetune-wo/scripts/zero3_offload.json', '--model_id', 'Qwen/Qwen2-VL-2B-Instruct', '--data_path', '/home/jwlee/volume/Qwen2-vl-finetune-wo/synth_rx/train_cord.json', '--image_folder', '/home/jwlee/volume/Qwen2-vl-finetune-wo/data/cord_sample/images', '--remove_unused_columns', 'False', '--freeze_vision_tower', 'False', '--freeze_llm', 'True', '--freeze_merger', 'False', '--bf16', 'True', '--fp16', 'False', '--disable_flash_attn2', 'False', '--output_dir', '/home/jwlee/volume/Qwen2-vl-finetune-wo/output/qwen2vl_cord', '--num_train_epochs', '2', '--per_device_train_batch_size', '2', '--gradient_accumulation_steps', '8', '--image_min_pixels', '200704', '--image_max_pixels', '1097600', '--learning_rate', '1e-4', '--merger_lr', '1e-5', '--vision_lr', '2e-6', '--weight_decay', '0.1', '--warmup_ratio', '0.03', '--lr_scheduler_type', 'cosine', '--logging_steps', '1', '--tf32', 'True', '--gradient_checkpointing', 'True', '--report_to', 'tensorboard', '--lazy_preprocess', 'True', '--save_strategy', 'steps', '--save_steps', '50', '--save_total_limit', '5', '--dataloader_num_workers', '2']
Traceback (most recent call last):
  File "/home/jwlee/volume/Qwen2-vl-finetune-wo/scripts/train_sft.py", line 6, in <module>
    from src.trainer import QwenSFTTrainer
ModuleNotFoundError: No module named 'src.trainer'
Traceback (most recent call last):
  File "/home/jwlee/volume/Qwen2-vl-finetune-wo/scripts/train_sft.py", line 6, in <module>
    from src.trainer import QwenSFTTrainer
ModuleNotFoundError: No module named 'src.trainer'
[2025-10-11 00:20:35,145] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 64780
[2025-10-11 00:20:35,145] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 64781
[2025-10-11 00:20:35,154] [ERROR] [launch.py:325:sigkill_handler] ['/home/jwlee/miniconda3/envs/train/bin/python3.11', '-u', '/home/jwlee/volume/Qwen2-vl-finetune-wo/scripts/train_sft.py', '--local_rank=1', '--use_liger', 'True', '--lora_enable', 'True', '--use_dora', 'False', '--lora_namespan_exclude', "['lm_head', 'embed_tokens']", '--lora_rank', '32', '--lora_alpha', '32', '--lora_dropout', '0.05', '--num_lora_modules', '-1', '--deepspeed', '/home/jwlee/volume/Qwen2-vl-finetune-wo/scripts/zero3_offload.json', '--model_id', 'Qwen/Qwen2-VL-2B-Instruct', '--data_path', '/home/jwlee/volume/Qwen2-vl-finetune-wo/synth_rx/train_cord.json', '--image_folder', '/home/jwlee/volume/Qwen2-vl-finetune-wo/data/cord_sample/images', '--remove_unused_columns', 'False', '--freeze_vision_tower', 'False', '--freeze_llm', 'True', '--freeze_merger', 'False', '--bf16', 'True', '--fp16', 'False', '--disable_flash_attn2', 'False', '--output_dir', '/home/jwlee/volume/Qwen2-vl-finetune-wo/output/qwen2vl_cord', '--num_train_epochs', '2', '--per_device_train_batch_size', '2', '--gradient_accumulation_steps', '8', '--image_min_pixels', '200704', '--image_max_pixels', '1097600', '--learning_rate', '1e-4', '--merger_lr', '1e-5', '--vision_lr', '2e-6', '--weight_decay', '0.1', '--warmup_ratio', '0.03', '--lr_scheduler_type', 'cosine', '--logging_steps', '1', '--tf32', 'True', '--gradient_checkpointing', 'True', '--report_to', 'tensorboard', '--lazy_preprocess', 'True', '--save_strategy', 'steps', '--save_steps', '50', '--save_total_limit', '5', '--dataloader_num_workers', '2'] exits with return code = 1
